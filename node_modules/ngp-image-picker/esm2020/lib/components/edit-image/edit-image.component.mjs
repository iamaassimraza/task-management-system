import { Component, Input, Output, EventEmitter } from '@angular/core';
import { convertImageUsingCanvas, saveState } from '../../functions/image-processing';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/forms";
import * as i3 from "../tabs/tabs.component";
import * as i4 from "../basic-filters/basic-filters.component";
import * as i5 from "../cropper-wrapper/cropper-wrapper.component";
// const Croppr = require('../../services/croppr-service')
export class EditImageComponent {
    constructor(chRef) {
        this.chRef = chRef;
        this.imageSrc = '';
        this.color = '';
        this.controlPanelIndex = 0;
        this.showCrop = false;
        this.observer = null;
        this.allFormats = ['webp', 'jpeg', 'png'];
        this.initialState = {};
        this.state = {
            quality: 92,
            maxHeight: 1000,
            maxWidth: 1000,
            cropHeight: 150,
            cropWidth: 150,
            maintainAspectRatio: true,
            format: 'jpeg',
            arrayCopiedImages: [],
            originImageSrc: '',
        };
        this.croppSize = { width: 150, height: 150 };
        this.isMobile = false;
        this.closeModal = new EventEmitter();
    }
    ngOnInit() {
        this.state = JSON.parse(JSON.stringify({ ...this.state, ...this.initialState }));
        // console.log(this.state);
        this.isMobile = window.innerWidth < 800;
        console.log('ðŸš€ ~ file: edit-image.component.ts ~ line 45 ~ EditImageComponent ~ ngOnInit ~ this.isMobile', this.isMobile);
    }
    onCloseEditPanel(saveChanges = false) {
        if (this.observer instanceof ResizeObserver) {
            let imageCroperElRef = document.getElementById('image-croper');
            let imageFullElRef = document.getElementById('image-full');
            this.observer.unobserve(imageCroperElRef);
            this.observer.unobserve(imageFullElRef);
        }
        this.showCrop = false;
        if (saveChanges)
            this.closeModal.next({ state: this.state, imageSrc: this.imageSrc });
        else
            this.closeModal.next(null);
    }
    onControlPanelIndexChange(idex) {
        this.controlPanelIndex = idex;
    }
    calculateSize() {
        if (this.imageSrc && this.imageSrc.length) {
            return Math.ceil(((3 / 4) * this.imageSrc.length) / 1024);
        }
        else {
            return "";
        }
    }
    async onChangeSize(changeHeight = false) {
        try {
            this.imageSrc = await convertImageUsingCanvas(this.state.originImageSrc, changeHeight, this.state);
            this.chRef.markForCheck();
        }
        catch (error) {
            console.log('ðŸš€ ~ file: edit-image.component.ts ~ line 76 ~ EditImageComponent ~ onChangeSize ~ error', error);
            this.chRef.markForCheck();
        }
    }
    async onChangeQuality() {
        try {
            this.imageSrc = await convertImageUsingCanvas(this.state.originImageSrc, false, this.state);
            this.chRef.markForCheck();
        }
        catch (error) {
            console.log('ðŸš€ ~ file: edit-image.component.ts ~ line 86 ~ EditImageComponent ~ onChangeQuality ~ error', error);
            this.chRef.markForCheck();
        }
    }
    async onChangeFormat() {
        try {
            this.imageSrc = await convertImageUsingCanvas(this.state.originImageSrc, false, this.state);
            this.chRef.markForCheck();
        }
        catch (error) {
            console.log('ðŸš€ ~ file: edit-image.component.ts ~ line 98 ~ EditImageComponent ~ onChangeFormat ~ error', error);
            this.chRef.markForCheck();
        }
    }
    async onRestore() {
        try {
            if (this.state.arrayCopiedImages.length > 1) {
                this.state.arrayCopiedImages.pop();
                let newValue = this.state.arrayCopiedImages[this.state.arrayCopiedImages.length - 1];
                this.state = {
                    ...this.state,
                    maxHeight: newValue.height,
                    maxWidth: newValue.width,
                    quality: newValue.quality,
                    format: newValue.format,
                    originImageSrc: newValue.originImageSrc,
                    basicFilters: newValue.basicFilters,
                };
                this.imageSrc = newValue.lastImage;
                this.chRef.markForCheck();
            }
        }
        catch (e) {
            console.log('ðŸš€ ~ file: edit-image.component.ts ~ line 126 ~ EditImageComponent ~ onRestore ~ e', e);
        }
    }
    onCroppUpdate(data) {
        this.croppState = data;
        this.state.cropHeight = data.height;
        this.state.cropWidth = data.width;
    }
    onChangeCrop() {
        this.croppSize = { width: this.state.cropWidth, height: this.state.cropHeight };
    }
    onCrop() {
        // const dataHolderRect = document.querySelector('.croppr-container').getBoundingClientRect();
        const canvas = document.createElement('canvas');
        return new Promise((resolve, reject) => {
            let ctx = canvas.getContext('2d');
            let image = new Image();
            image.src = this.imageSrc;
            image.onload = () => {
                // let ratio = image.height / dataHolderRect.height;
                let newWidth = this.croppState?.width;
                let newHeight = this.croppState?.height;
                canvas.height = newHeight;
                canvas.width = newWidth;
                ctx.drawImage(image, Math.abs(this.croppState?.x || 0), Math.abs(this.croppState?.y || 0), this.croppState?.width || 0, this.croppState?.height || 0, 0, 0, this.croppState?.width || 0, this.croppState?.height || 0);
                return resolve(canvas.toDataURL(`image/${this.state.format}`, this.state.quality));
            };
            image.onerror = (e) => {
                reject(e);
            };
        })
            .then((dataUri) => {
            this.imageSrc = dataUri;
            this.showCrop = false;
            this.state.maxWidth = canvas.width;
            this.state.maxHeight = canvas.height;
            this.state.originImageSrc = dataUri;
            this.state.cropHeight = 150;
            this.state.cropWidth = 150;
            saveState(this.state, dataUri);
            this.croppSize = { width: 150, height: 150 };
            this.chRef.markForCheck();
        })
            .catch((e) => {
            console.log(e);
        });
    }
    async onChangeFilters(data) {
        try {
            if (!this.state.basicFilters) {
                this.state.basicFilters = data;
            }
            else {
                this.state.basicFilters = { ...this.state.basicFilters, ...data };
            }
            this.imageSrc = await convertImageUsingCanvas(this.state.originImageSrc, false, this.state);
            this.chRef.markForCheck();
        }
        catch (e) {
            console.log('ðŸš€ ~ file: edit-image.component.ts ~ line 250 ~ EditImageComponent ~ onChangeFilters ~ e', e);
        }
    }
}
EditImageComponent.Éµfac = i0.ÉµÉµngDeclareFactory({ minVersion: "12.0.0", version: "15.0.4", ngImport: i0, type: EditImageComponent, deps: [{ token: i0.ChangeDetectorRef }], target: i0.ÉµÉµFactoryTarget.Component });
EditImageComponent.Éµcmp = i0.ÉµÉµngDeclareComponent({ minVersion: "14.0.0", version: "15.0.4", type: EditImageComponent, selector: "lib-edit-image", inputs: { labels: "labels", imageSrc: "imageSrc", color: "color", initialState: "initialState" }, outputs: { closeModal: "closeModal" }, ngImport: i0, template: "<div id=\"popup\" class=\"popup\">\n  <div\n    style=\"\n      flex-direction: row;\n      box-sizing: border-box;\n      display: flex;\n      place-content: center flex-end;\n      align-items: center;\n      padding: 0px 16px;\n    \"\n  >\n    <button class=\"icon-btn\" (click)=\"onCloseEditPanel(false)\">\n      <span class=\"material-icons\">clear</span>\n    </button>\n  </div>\n\n  <div class=\"image-container\">\n    <div class=\"image-holder-full\">\n      <img id=\"image-full\" [src]=\"this.imageSrc\" [style.display]=\"showCrop ? 'none' : ''\" />\n\n      <lib-cropper-wrapper\n        [setSize]=\"this.croppSize\"\n        (croppUpdate)=\"onCroppUpdate($event)\"\n        [_imageSrc]=\"this.imageSrc\"\n        *ngIf=\"showCrop\"\n      ></lib-cropper-wrapper>\n    </div>\n\n    <div class=\"control-panel\">\n      <lib-tabs [color]=\"this.color\" [_labels]=\"['Basic', 'Filters']\" (indexActivatedChange)=\"onControlPanelIndexChange($event)\">\n        <ng-container *ngIf=\"controlPanelIndex == 0\">\n          <ng-container *ngIf=\"!isMobile || (isMobile && !showCrop)\">\n            <div style=\"display: flex; width: 100%; justify-content: space-between\">\n              <p class=\"item-panel\">{{ labels['Quality'] }}</p>\n              <p class=\"item-panel\">{{ this.state.quality + '%' }}</p>\n            </div>\n\n            <div style=\"flex-direction: row; box-sizing: border-box; display: flex; place-content: flex-start; align-items: flex-start\">\n              <input\n                [readonly]=\"showCrop\"\n                [disabled]=\"showCrop\"\n                class=\"input-range\"\n                (change)=\"onChangeQuality()\"\n                [ngStyle]=\"{ maxWidth: '100%', width: '100%', color: color }\"\n                [(ngModel)]=\"this.state.quality\"\n                type=\"range\"\n                min=\"1\"\n                max=\"100\"\n                value=\"50\"\n              />\n            </div>\n\n            <div class=\"item-panel\" style=\"display: flex; width: 100%; justify-content: space-between\">\n              {{ labels['Max dimensions'] }}\n              <div style=\"display: flex; align-items: center\">\n                <input\n                  [readonly]=\"showCrop\"\n                  [disabled]=\"showCrop\"\n                  type=\"checkbox\"\n                  [(ngModel)]=\"this.state.maintainAspectRatio\"\n                  [style.color]=\"color\"\n                />\n                <span class=\"caption\">{{ labels['aspect-ratio'] }}</span>\n              </div>\n            </div>\n\n            <div\n              style=\"\n                margin-top: 8px !important;\n                flex-flow: row wrap;\n                box-sizing: border-box;\n                display: flex;\n                place-content: flex-start space-between;\n                align-items: flex-start;\n              \"\n            >\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%\">\n                <label>{{ labels['max-width(px)'] }}</label>\n                <input\n                  [readonly]=\"showCrop\"\n                  [disabled]=\"showCrop\"\n                  (change)=\"onChangeSize(false)\"\n                  placeholder=\"{{ labels['max-width(px)'] }}\"\n                  [(ngModel)]=\"this.state.maxWidth\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%\">\n                <label>{{ labels['max-height(px)'] }}</label>\n                <input\n                  [readonly]=\"showCrop\"\n                  [disabled]=\"showCrop\"\n                  (change)=\"onChangeSize(true)\"\n                  placeholder=\"{{ labels['max-height(px)'] }}\"\n                  [(ngModel)]=\"this.state.maxHeight\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n            </div>\n\n            <p class=\"item-panel\">{{ labels['Format'] }}</p>\n            <div\n              style=\"\n                margin-top: 8px !important;\n                flex-direction: row;\n                box-sizing: border-box;\n                display: flex;\n                place-content: flex-start;\n                align-items: flex-start;\n              \"\n            >\n              <div class=\"form-field\" style=\"width: 100%\">\n                <select [disabled]=\"showCrop\" [(ngModel)]=\"this.state.format\" (change)=\"onChangeFormat()\">\n                  <option *ngFor=\"let formatItem of allFormats\" [value]=\"formatItem\">{{ formatItem }}</option>\n                </select>\n              </div>\n            </div>\n          </ng-container>\n          <!-- <p class=\"item-panel\">{{ labels['Rotate'] }}</p>\n\n          <div\n            style=\"\n              margin-top: 8px !important;\n              flex-direction: row;\n              box-sizing: border-box;\n              display: flex;\n              place-content: flex-start;\n              align-items: flex-start;\n            \"\n          >\n            <button [disabled]=\"showCrop\" class=\"icon-btn\" style=\"padding-left: 0px\" (click)=\"onRotate(90)\">\n              <span class=\"material-icons\"> rotate_left </span>\n            </button>\n            <button [disabled]=\"showCrop\" class=\"icon-btn\" (click)=\"onRestore()\" (click)=\"onRotate(-90)\">\n              <span class=\"material-icons\"> rotate_right </span>\n            </button>\n          </div>\n\n          <hr />\n          <br /> -->\n\n          <div style=\"display: flex; justify-content: space-between; margin-bottom: 8px\">\n            <span style=\"display: flex; align-items: center\">\n              <input type=\"checkbox\" [(ngModel)]=\"showCrop\" [style.color]=\"color\" style=\"margin-bottom: 3px\" />\n              <span class=\"item-panel\" style=\"margin-left: 4px\">{{ labels['Crop'] }}</span>\n            </span>\n          </div>\n\n          <ng-container *ngIf=\"showCrop\">\n            <div\n              style=\"\n                margin-top: 8px !important;\n                flex-flow: row wrap;\n                box-sizing: border-box;\n                display: flex;\n                place-content: flex-start space-between;\n                align-items: flex-start;\n              \"\n            >\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%; margin-bottom: 8px\">\n                <label>{{ labels['width(px)'] }}</label>\n                <input\n                  (change)=\"onChangeCrop()\"\n                  placeholder=\"{{ labels['width(px)'] }}\"\n                  [(ngModel)]=\"state.cropWidth\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%; margin-bottom: 8px\">\n                <label>{{ labels['height(px)'] }}</label>\n                <input\n                  (change)=\"onChangeCrop()\"\n                  placeholder=\"{{ labels['height(px)'] }}\"\n                  [(ngModel)]=\"state.cropHeight\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n            </div>\n\n            <p style=\"margin-bottom: 4px !important\">\n              <button title=\"Cut the image\" class=\"icon-btn\" (click)=\"onCrop()\">\n                <span class=\"material-icons\"> crop </span>\n              </button>\n            </p>\n          </ng-container>\n        </ng-container>\n        <ng-container *ngIf=\"controlPanelIndex == 1\">\n          <lib-basic-filters\n            [filterState]=\"this.state.basicFilters\"\n            (changeFilter)=\"onChangeFilters($event)\"\n            [labels]=\"this.labels\"\n            [color]=\"this.color\"\n          ></lib-basic-filters>\n        </ng-container>\n      </lib-tabs>\n\n      <button\n        title=\"{{ labels['Undo'] }}\"\n        [disabled]=\"this.state.arrayCopiedImages.length <= 1\"\n        style=\"position: absolute; right: 10px; top: 30px\"\n        class=\"icon-btn\"\n        (click)=\"onRestore()\"\n      >\n        <span class=\"material-icons\"> refresh </span>\n      </button>\n      <div\n        style=\"\n          flex-direction: row;\n          box-sizing: border-box;\n          display: flex;\n          place-content: center space-between;\n          align-items: center;\n          margin-top: 8px;\n        \"\n      >\n        <button class=\"save-btn\" (click)=\"onCloseEditPanel(true)\">{{ labels['Save'] }}</button>\n\n        <p\n          *ngIf=\"this.calculateSize()\"\n          class=\"caption image-caption\"\n          [ngStyle]=\"{\n            color: this.calculateSize() > 120 ? '#f44336' : 'unset',\n            fontWeight: this.calculateSize() > 120 ? '500' : 'unset'\n          }\"\n        >\n          size: {{ this.calculateSize() }}Kb &nbsp; {{ this.state.format }}\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n", styles: [".popup{width:100vw;max-height:100%;height:100%;overflow:auto;position:fixed;top:0;left:0;background-color:#000c;z-index:1000;padding:24px 16px;color:#fff;box-sizing:border-box;animation-name:show;animation-duration:.4s}.popup .image-container{margin-top:50px;margin-bottom:50px;width:100%;flex-flow:row wrap;box-sizing:border-box;display:flex;place-content:flex-start center;align-items:flex-start}.popup .image-container .image-holder-full{height:auto;width:auto;position:relative;display:contents}.popup .material-icons{color:#fff}.popup img{vertical-align:middle;max-height:650px;max-width:100%;object-fit:cover;object-position:center}@media (max-width: 1024px){.popup{background-color:#000000d9;padding:8px}.popup img{max-height:100%;max-width:100%}}@media (max-width: 599px){.popup img{margin:0}}.popup .control-panel{color:#fff;background-color:#000000eb;margin:0 16px;padding:16px;width:18rem;border-radius:8px;flex-direction:column;box-sizing:border-box;display:flex;place-content:stretch flex-start;align-items:stretch;max-width:100%;position:relative}@media (max-width: 599px){.popup .control-panel{margin:8px 0;width:100%}}.popup .control-panel .title-panel{padding:0 4px;font-size:17px;font-weight:500;margin-bottom:16px!important}.popup .control-panel .item-panel{padding:0;font-size:14px;font-weight:500}.image-croper{position:absolute;width:180px;height:180px;min-height:64px;min-width:64px;border:2.5px solid #fafafa;box-sizing:border-box;resize:both;overflow:auto;opacity:0;border-radius:4px;overflow:hidden;z-index:10}.image-croper #image-croper-header{padding:0;cursor:move;z-index:9;background-color:transparent;color:#fff;height:100%;display:grid;gap:0px;grid-template-columns:repeat(3,1fr);width:100%;box-sizing:border-box;position:absolute;top:50%;transform:translateY(-50%);opacity:.8}.image-croper #image-croper-header .material-icons{color:#fff}.input-range{margin-bottom:16px;margin-top:4px}input[type=checkbox]{cursor:pointer}.form-field{margin-bottom:16px}.form-field label{font-size:12px;opacity:.92;margin-bottom:4px;display:block}.form-field input{height:34px;width:100%;box-sizing:border-box;border-radius:4px;border:none;padding:2px 8px;outline:none}.form-field select{height:34px;width:100%;box-sizing:border-box;border-radius:4px;border:none;padding:2px 8px;outline:none;background-color:#fff}.save-btn{padding:0 8px;height:34px;box-sizing:border-box;background-color:#fff;color:#000;border:none;border-radius:4px;cursor:pointer}.save-btn:active{transform:scale(.95)}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "directive", type: i2.NgSelectOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i2.ÉµNgSelectMultipleOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.NumberValueAccessor, selector: "input[type=number][formControlName],input[type=number][formControl],input[type=number][ngModel]" }, { kind: "directive", type: i2.RangeValueAccessor, selector: "input[type=range][formControlName],input[type=range][formControl],input[type=range][ngModel]" }, { kind: "directive", type: i2.CheckboxControlValueAccessor, selector: "input[type=checkbox][formControlName],input[type=checkbox][formControl],input[type=checkbox][ngModel]" }, { kind: "directive", type: i2.SelectControlValueAccessor, selector: "select:not([multiple])[formControlName],select:not([multiple])[formControl],select:not([multiple])[ngModel]", inputs: ["compareWith"] }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.MinValidator, selector: "input[type=number][min][formControlName],input[type=number][min][formControl],input[type=number][min][ngModel]", inputs: ["min"] }, { kind: "directive", type: i2.MaxValidator, selector: "input[type=number][max][formControlName],input[type=number][max][formControl],input[type=number][max][ngModel]", inputs: ["max"] }, { kind: "directive", type: i2.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "component", type: i3.TabsComponent, selector: "lib-tabs", inputs: ["color", "_labels", "_indexActivated"], outputs: ["indexActivatedChange"] }, { kind: "component", type: i4.BasicFiltersComponent, selector: "lib-basic-filters", inputs: ["color", "labels", "filterState"], outputs: ["changeFilter"] }, { kind: "component", type: i5.CropperWrapperComponent, selector: "lib-cropper-wrapper", inputs: ["_imageSrc", "setSize"], outputs: ["croppUpdate"] }] });
i0.ÉµÉµngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.0.4", ngImport: i0, type: EditImageComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lib-edit-image', template: "<div id=\"popup\" class=\"popup\">\n  <div\n    style=\"\n      flex-direction: row;\n      box-sizing: border-box;\n      display: flex;\n      place-content: center flex-end;\n      align-items: center;\n      padding: 0px 16px;\n    \"\n  >\n    <button class=\"icon-btn\" (click)=\"onCloseEditPanel(false)\">\n      <span class=\"material-icons\">clear</span>\n    </button>\n  </div>\n\n  <div class=\"image-container\">\n    <div class=\"image-holder-full\">\n      <img id=\"image-full\" [src]=\"this.imageSrc\" [style.display]=\"showCrop ? 'none' : ''\" />\n\n      <lib-cropper-wrapper\n        [setSize]=\"this.croppSize\"\n        (croppUpdate)=\"onCroppUpdate($event)\"\n        [_imageSrc]=\"this.imageSrc\"\n        *ngIf=\"showCrop\"\n      ></lib-cropper-wrapper>\n    </div>\n\n    <div class=\"control-panel\">\n      <lib-tabs [color]=\"this.color\" [_labels]=\"['Basic', 'Filters']\" (indexActivatedChange)=\"onControlPanelIndexChange($event)\">\n        <ng-container *ngIf=\"controlPanelIndex == 0\">\n          <ng-container *ngIf=\"!isMobile || (isMobile && !showCrop)\">\n            <div style=\"display: flex; width: 100%; justify-content: space-between\">\n              <p class=\"item-panel\">{{ labels['Quality'] }}</p>\n              <p class=\"item-panel\">{{ this.state.quality + '%' }}</p>\n            </div>\n\n            <div style=\"flex-direction: row; box-sizing: border-box; display: flex; place-content: flex-start; align-items: flex-start\">\n              <input\n                [readonly]=\"showCrop\"\n                [disabled]=\"showCrop\"\n                class=\"input-range\"\n                (change)=\"onChangeQuality()\"\n                [ngStyle]=\"{ maxWidth: '100%', width: '100%', color: color }\"\n                [(ngModel)]=\"this.state.quality\"\n                type=\"range\"\n                min=\"1\"\n                max=\"100\"\n                value=\"50\"\n              />\n            </div>\n\n            <div class=\"item-panel\" style=\"display: flex; width: 100%; justify-content: space-between\">\n              {{ labels['Max dimensions'] }}\n              <div style=\"display: flex; align-items: center\">\n                <input\n                  [readonly]=\"showCrop\"\n                  [disabled]=\"showCrop\"\n                  type=\"checkbox\"\n                  [(ngModel)]=\"this.state.maintainAspectRatio\"\n                  [style.color]=\"color\"\n                />\n                <span class=\"caption\">{{ labels['aspect-ratio'] }}</span>\n              </div>\n            </div>\n\n            <div\n              style=\"\n                margin-top: 8px !important;\n                flex-flow: row wrap;\n                box-sizing: border-box;\n                display: flex;\n                place-content: flex-start space-between;\n                align-items: flex-start;\n              \"\n            >\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%\">\n                <label>{{ labels['max-width(px)'] }}</label>\n                <input\n                  [readonly]=\"showCrop\"\n                  [disabled]=\"showCrop\"\n                  (change)=\"onChangeSize(false)\"\n                  placeholder=\"{{ labels['max-width(px)'] }}\"\n                  [(ngModel)]=\"this.state.maxWidth\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%\">\n                <label>{{ labels['max-height(px)'] }}</label>\n                <input\n                  [readonly]=\"showCrop\"\n                  [disabled]=\"showCrop\"\n                  (change)=\"onChangeSize(true)\"\n                  placeholder=\"{{ labels['max-height(px)'] }}\"\n                  [(ngModel)]=\"this.state.maxHeight\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n            </div>\n\n            <p class=\"item-panel\">{{ labels['Format'] }}</p>\n            <div\n              style=\"\n                margin-top: 8px !important;\n                flex-direction: row;\n                box-sizing: border-box;\n                display: flex;\n                place-content: flex-start;\n                align-items: flex-start;\n              \"\n            >\n              <div class=\"form-field\" style=\"width: 100%\">\n                <select [disabled]=\"showCrop\" [(ngModel)]=\"this.state.format\" (change)=\"onChangeFormat()\">\n                  <option *ngFor=\"let formatItem of allFormats\" [value]=\"formatItem\">{{ formatItem }}</option>\n                </select>\n              </div>\n            </div>\n          </ng-container>\n          <!-- <p class=\"item-panel\">{{ labels['Rotate'] }}</p>\n\n          <div\n            style=\"\n              margin-top: 8px !important;\n              flex-direction: row;\n              box-sizing: border-box;\n              display: flex;\n              place-content: flex-start;\n              align-items: flex-start;\n            \"\n          >\n            <button [disabled]=\"showCrop\" class=\"icon-btn\" style=\"padding-left: 0px\" (click)=\"onRotate(90)\">\n              <span class=\"material-icons\"> rotate_left </span>\n            </button>\n            <button [disabled]=\"showCrop\" class=\"icon-btn\" (click)=\"onRestore()\" (click)=\"onRotate(-90)\">\n              <span class=\"material-icons\"> rotate_right </span>\n            </button>\n          </div>\n\n          <hr />\n          <br /> -->\n\n          <div style=\"display: flex; justify-content: space-between; margin-bottom: 8px\">\n            <span style=\"display: flex; align-items: center\">\n              <input type=\"checkbox\" [(ngModel)]=\"showCrop\" [style.color]=\"color\" style=\"margin-bottom: 3px\" />\n              <span class=\"item-panel\" style=\"margin-left: 4px\">{{ labels['Crop'] }}</span>\n            </span>\n          </div>\n\n          <ng-container *ngIf=\"showCrop\">\n            <div\n              style=\"\n                margin-top: 8px !important;\n                flex-flow: row wrap;\n                box-sizing: border-box;\n                display: flex;\n                place-content: flex-start space-between;\n                align-items: flex-start;\n              \"\n            >\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%; margin-bottom: 8px\">\n                <label>{{ labels['width(px)'] }}</label>\n                <input\n                  (change)=\"onChangeCrop()\"\n                  placeholder=\"{{ labels['width(px)'] }}\"\n                  [(ngModel)]=\"state.cropWidth\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n              <div class=\"form-field\" style=\"max-width: 48%; width: 48%; margin-bottom: 8px\">\n                <label>{{ labels['height(px)'] }}</label>\n                <input\n                  (change)=\"onChangeCrop()\"\n                  placeholder=\"{{ labels['height(px)'] }}\"\n                  [(ngModel)]=\"state.cropHeight\"\n                  type=\"number\"\n                  [min]=\"0\"\n                  [max]=\"2000\"\n                />\n              </div>\n            </div>\n\n            <p style=\"margin-bottom: 4px !important\">\n              <button title=\"Cut the image\" class=\"icon-btn\" (click)=\"onCrop()\">\n                <span class=\"material-icons\"> crop </span>\n              </button>\n            </p>\n          </ng-container>\n        </ng-container>\n        <ng-container *ngIf=\"controlPanelIndex == 1\">\n          <lib-basic-filters\n            [filterState]=\"this.state.basicFilters\"\n            (changeFilter)=\"onChangeFilters($event)\"\n            [labels]=\"this.labels\"\n            [color]=\"this.color\"\n          ></lib-basic-filters>\n        </ng-container>\n      </lib-tabs>\n\n      <button\n        title=\"{{ labels['Undo'] }}\"\n        [disabled]=\"this.state.arrayCopiedImages.length <= 1\"\n        style=\"position: absolute; right: 10px; top: 30px\"\n        class=\"icon-btn\"\n        (click)=\"onRestore()\"\n      >\n        <span class=\"material-icons\"> refresh </span>\n      </button>\n      <div\n        style=\"\n          flex-direction: row;\n          box-sizing: border-box;\n          display: flex;\n          place-content: center space-between;\n          align-items: center;\n          margin-top: 8px;\n        \"\n      >\n        <button class=\"save-btn\" (click)=\"onCloseEditPanel(true)\">{{ labels['Save'] }}</button>\n\n        <p\n          *ngIf=\"this.calculateSize()\"\n          class=\"caption image-caption\"\n          [ngStyle]=\"{\n            color: this.calculateSize() > 120 ? '#f44336' : 'unset',\n            fontWeight: this.calculateSize() > 120 ? '500' : 'unset'\n          }\"\n        >\n          size: {{ this.calculateSize() }}Kb &nbsp; {{ this.state.format }}\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n", styles: [".popup{width:100vw;max-height:100%;height:100%;overflow:auto;position:fixed;top:0;left:0;background-color:#000c;z-index:1000;padding:24px 16px;color:#fff;box-sizing:border-box;animation-name:show;animation-duration:.4s}.popup .image-container{margin-top:50px;margin-bottom:50px;width:100%;flex-flow:row wrap;box-sizing:border-box;display:flex;place-content:flex-start center;align-items:flex-start}.popup .image-container .image-holder-full{height:auto;width:auto;position:relative;display:contents}.popup .material-icons{color:#fff}.popup img{vertical-align:middle;max-height:650px;max-width:100%;object-fit:cover;object-position:center}@media (max-width: 1024px){.popup{background-color:#000000d9;padding:8px}.popup img{max-height:100%;max-width:100%}}@media (max-width: 599px){.popup img{margin:0}}.popup .control-panel{color:#fff;background-color:#000000eb;margin:0 16px;padding:16px;width:18rem;border-radius:8px;flex-direction:column;box-sizing:border-box;display:flex;place-content:stretch flex-start;align-items:stretch;max-width:100%;position:relative}@media (max-width: 599px){.popup .control-panel{margin:8px 0;width:100%}}.popup .control-panel .title-panel{padding:0 4px;font-size:17px;font-weight:500;margin-bottom:16px!important}.popup .control-panel .item-panel{padding:0;font-size:14px;font-weight:500}.image-croper{position:absolute;width:180px;height:180px;min-height:64px;min-width:64px;border:2.5px solid #fafafa;box-sizing:border-box;resize:both;overflow:auto;opacity:0;border-radius:4px;overflow:hidden;z-index:10}.image-croper #image-croper-header{padding:0;cursor:move;z-index:9;background-color:transparent;color:#fff;height:100%;display:grid;gap:0px;grid-template-columns:repeat(3,1fr);width:100%;box-sizing:border-box;position:absolute;top:50%;transform:translateY(-50%);opacity:.8}.image-croper #image-croper-header .material-icons{color:#fff}.input-range{margin-bottom:16px;margin-top:4px}input[type=checkbox]{cursor:pointer}.form-field{margin-bottom:16px}.form-field label{font-size:12px;opacity:.92;margin-bottom:4px;display:block}.form-field input{height:34px;width:100%;box-sizing:border-box;border-radius:4px;border:none;padding:2px 8px;outline:none}.form-field select{height:34px;width:100%;box-sizing:border-box;border-radius:4px;border:none;padding:2px 8px;outline:none;background-color:#fff}.save-btn{padding:0 8px;height:34px;box-sizing:border-box;background-color:#fff;color:#000;border:none;border-radius:4px;cursor:pointer}.save-btn:active{transform:scale(.95)}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }]; }, propDecorators: { labels: [{
                type: Input
            }], imageSrc: [{
                type: Input
            }], color: [{
                type: Input
            }], initialState: [{
                type: Input
            }], closeModal: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdC1pbWFnZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3AtaW1hZ2UtcGlja2VyL3NyYy9saWIvY29tcG9uZW50cy9lZGl0LWltYWdlL2VkaXQtaW1hZ2UuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmdwLWltYWdlLXBpY2tlci9zcmMvbGliL2NvbXBvbmVudHMvZWRpdC1pbWFnZS9lZGl0LWltYWdlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBRSxZQUFZLEVBQW9DLE1BQU0sZUFBZSxDQUFDO0FBQ2pILE9BQU8sRUFBRSx1QkFBdUIsRUFBdUMsU0FBUyxFQUFFLE1BQU0sa0NBQWtDLENBQUM7Ozs7Ozs7QUFHM0gsMERBQTBEO0FBTTFELE1BQU0sT0FBTyxrQkFBa0I7SUE0QjdCLFlBQW9CLEtBQXdCO1FBQXhCLFVBQUssR0FBTCxLQUFLLENBQW1CO1FBMUJuQyxhQUFRLEdBQVcsRUFBRSxDQUFDO1FBQ3RCLFVBQUssR0FBVyxFQUFFLENBQUM7UUFDNUIsc0JBQWlCLEdBQVcsQ0FBQyxDQUFDO1FBQzlCLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFDMUIsYUFBUSxHQUFzQyxJQUFJLENBQUM7UUFDbkQsZUFBVSxHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQztRQUU1QixpQkFBWSxHQUF3QixFQUFFLENBQUM7UUFFaEQsVUFBSyxHQUFXO1lBQ2QsT0FBTyxFQUFFLEVBQUU7WUFDWCxTQUFTLEVBQUUsSUFBSTtZQUNmLFFBQVEsRUFBRSxJQUFJO1lBQ2QsVUFBVSxFQUFFLEdBQUc7WUFDZixTQUFTLEVBQUUsR0FBRztZQUNkLG1CQUFtQixFQUFFLElBQUk7WUFDekIsTUFBTSxFQUFFLE1BQU07WUFDZCxpQkFB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QUMsS0FBSyxDQUFDLFlBQVksRUFBRSxDQUFDO1NBQzNCO1FBQUMsT0FBTyxDQUFDLEVBQUU7WUFDVixPQUFPLENBQUMsR0FBRyxDQUFDLDBGQUEwRixFQUFFLENBQUMsQ0FBQyxDQUFDO1NBQzVHO0lBQ0gsQ0FBQzs7K0dBdExVLGtCQUFrQjttR0FBbEIsa0JBQWtCLCtMQ1YvQiw2Z1NBZ1BBOzJGRHRPYSxrQkFBa0I7a0JBTDlCLFNBQVM7K0JBQ0UsZ0JBQWdCO3dHQUtqQixNQUFNO3NCQUFkLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxLQUFLO3NCQUFiLEtBQUs7Z0JBTUcsWUFBWTtzQkFBcEIsS0FBSztnQkFpQkksVUFBVTtzQkFBbkIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIENoYW5nZURldGVjdG9yUmVmLCBBZnRlclZpZXdJbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBjb252ZXJ0SW1hZ2VVc2luZ0NhbnZhcywgZHJhZ0VsZW1lbnQsIE1BWF9CVUZGRVJfVU5ET19NRU1PUlksIHNhdmVTdGF0ZSB9IGZyb20gJy4uLy4uL2Z1bmN0aW9ucy9pbWFnZS1wcm9jZXNzaW5nJztcbmltcG9ydCB7IElCYXNpY0ZpbHRlclN0YXRlLCBJU3RhdGUgfSBmcm9tICcuLi8uLi9tb2RlbHMvaW5kZXgubW9kZWxzJztcblxuLy8gY29uc3QgQ3JvcHByID0gcmVxdWlyZSgnLi4vLi4vc2VydmljZXMvY3JvcHByLXNlcnZpY2UnKVxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbGliLWVkaXQtaW1hZ2UnLFxuICB0ZW1wbGF0ZVVybDogJy4vZWRpdC1pbWFnZS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2VkaXQtaW1hZ2UuY29tcG9uZW50LnNjc3MnXSxcbn0pXG5leHBvcnQgY2xhc3MgRWRpdEltYWdlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KCkgbGFiZWxzOiBhbnk7XG4gIEBJbnB1dCgpIGltYWdlU3JjOiBzdHJpbmcgPSAnJztcbiAgQElucHV0KCkgY29sb3I6IHN0cmluZyA9ICcnO1xuICBjb250cm9sUGFuZWxJbmRleDogbnVtYmVyID0gMDtcbiAgc2hvd0Nyb3A6IGJvb2xlYW4gPSBmYWxzZTtcbiAgb2JzZXJ2ZXI6IFJlc2l6ZU9ic2VydmVyIHwgdW5kZWZpbmVkIHwgbnVsbCA9IG51bGw7XG4gIGFsbEZvcm1hdHMgPSBbJ3dlYnAnLCAnanBlZycsICdwbmcnXTtcblxuICBASW5wdXQoKSBpbml0aWFsU3RhdGU6IElTdGF0ZSB8IG51bGwgfCBhbnkgPSB7fTtcblxuICBzdGF0ZTogSVN0YXRlID0ge1xuICAgIHF1YWxpdHk6IDkyLFxuICAgIG1heEhlaWdodDogMTAwMCxcbiAgICBtYXhXaWR0aDogMTAwMCxcbiAgICBjcm9wSGVpZ2h0OiAxNTAsXG4gICAgY3JvcFdpZHRoOiAxNTAsXG4gICAgbWFpbnRhaW5Bc3BlY3RSYXRpbzogdHJ1ZSxcbiAgICBmb3JtYXQ6ICdqcGVnJyxcbiAgICBhcnJheUNvcGllZEltYWdlczogW10sXG4gICAgb3JpZ2luSW1hZ2VTcmM6ICcnLFxuICB9O1xuICBjcm9wcFN0YXRlOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9IHwgdW5kZWZpbmVkIHwgbnVsbDtcbiAgY3JvcHBTaXplOiB7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH0gPSB7IHdpZHRoOiAxNTAsIGhlaWdodDogMTUwIH07XG4gIGlzTW9iaWxlID0gZmFsc2U7XG5cbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPHsgc3RhdGU6IElTdGF0ZTsgaW1hZ2VTcmM6IHN0cmluZyB9IHwgbnVsbCB8IHVuZGVmaW5lZD4oKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNoUmVmOiBDaGFuZ2VEZXRlY3RvclJlZikge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnN0YXRlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh7IC4uLnRoaXMuc3RhdGUsIC4uLnRoaXMuaW5pdGlhbFN0YXRlIH0pKTtcbiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnN0YXRlKTtcbiAgICB0aGlzLmlzTW9iaWxlID0gd2luZG93LmlubmVyV2lkdGggPCA4MDA7XG4gICAgY29uc29sZS5sb2coJ/CfmoAgfiBmaWxlOiBlZGl0LWltYWdlLmNvbXBvbmVudC50cyB+IGxpbmUgNDUgfiBFZGl0SW1hZ2VDb21wb25lbnQgfiBuZ09uSW5pdCB+IHRoaXMuaXNNb2JpbGUnLCB0aGlzLmlzTW9iaWxlKTtcbiAgfVxuXG4gIG9uQ2xvc2VFZGl0UGFuZWwoc2F2ZUNoYW5nZXM6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgIGlmICh0aGlzLm9ic2VydmVyIGluc3RhbmNlb2YgUmVzaXplT2JzZXJ2ZXIpIHtcbiAgICAgIGxldCBpbWFnZUNyb3BlckVsUmVmOiBhbnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hZ2UtY3JvcGVyJyk7XG4gICAgICBsZXQgaW1hZ2VGdWxsRWxSZWY6IGFueSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWFnZS1mdWxsJyk7XG4gICAgICB0aGlzLm9ic2VydmVyLnVub2JzZXJ2ZShpbWFnZUNyb3BlckVsUmVmKTtcbiAgICAgIHRoaXMub2JzZXJ2ZXIudW5vYnNlcnZlKGltYWdlRnVsbEVsUmVmKTtcbiAgICB9XG4gICAgdGhpcy5zaG93Q3JvcCA9IGZhbHNlO1xuICAgIGlmIChzYXZlQ2hhbmdlcykgdGhpcy5jbG9zZU1vZGFsLm5leHQoeyBzdGF0ZTogdGhpcy5zdGF0ZSwgaW1hZ2VTcmM6IHRoaXMuaW1hZ2VTcmMgfSk7XG4gICAgZWxzZSB0aGlzLmNsb3NlTW9kYWwubmV4dChudWxsKTtcbiAgfVxuXG4gIG9uQ29udHJvbFBhbmVsSW5kZXhDaGFuZ2UoaWRleDogbnVtYmVyKSB7XG4gICAgdGhpcy5jb250cm9sUGFuZWxJbmRleCA9IGlkZXg7XG4gIH1cblxuICBjYWxjdWxhdGVTaXplKCkge1xuICAgIGlmICh0aGlzLmltYWdlU3JjICYmIHRoaXMuaW1hZ2VTcmMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gTWF0aC5jZWlsKCgoMyAvIDQpICogdGhpcy5pbWFnZVNyYy5sZW5ndGgpIC8gMTAyNCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG9uQ2hhbmdlU2l6ZShjaGFuZ2VIZWlnaHQgPSBmYWxzZSkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmltYWdlU3JjID0gYXdhaXQgY29udmVydEltYWdlVXNpbmdDYW52YXModGhpcy5zdGF0ZS5vcmlnaW5JbWFnZVNyYywgY2hhbmdlSGVpZ2h0LCB0aGlzLnN0YXRlKTtcbiAgICAgIHRoaXMuY2hSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qAIH4gZmlsZTogZWRpdC1pbWFnZS5jb21wb25lbnQudHMgfiBsaW5lIDc2IH4gRWRpdEltYWdlQ29tcG9uZW50IH4gb25DaGFuZ2VTaXplIH4gZXJyb3InLCBlcnJvcik7XG4gICAgICB0aGlzLmNoUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG9uQ2hhbmdlUXVhbGl0eSgpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5pbWFnZVNyYyA9IGF3YWl0IGNvbnZlcnRJbWFnZVVzaW5nQ2FudmFzKHRoaXMuc3RhdGUub3JpZ2luSW1hZ2VTcmMsIGZhbHNlLCB0aGlzLnN0YXRlKTtcbiAgICAgIHRoaXMuY2hSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qAIH4gZmlsZTogZWRpdC1pbWFnZS5jb21wb25lbnQudHMgfiBsaW5lIDg2IH4gRWRpdEltYWdlQ29tcG9uZW50IH4gb25DaGFuZ2VRdWFsaXR5IH4gZXJyb3InLCBlcnJvcik7XG4gICAgICB0aGlzLmNoUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG9uQ2hhbmdlRm9ybWF0KCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmltYWdlU3JjID0gYXdhaXQgY29udmVydEltYWdlVXNpbmdDYW52YXModGhpcy5zdGF0ZS5vcmlnaW5JbWFnZVNyYywgZmFsc2UsIHRoaXMuc3RhdGUpO1xuICAgICAgdGhpcy5jaFJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coJ/CfmoAgfiBmaWxlOiBlZGl0LWltYWdlLmNvbXBvbmVudC50cyB+IGxpbmUgOTggfiBFZGl0SW1hZ2VDb21wb25lbnQgfiBvbkNoYW5nZUZvcm1hdCB+IGVycm9yJywgZXJyb3IpO1xuICAgICAgdGhpcy5jaFJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBvblJlc3RvcmUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLnN0YXRlLmFycmF5Q29waWVkSW1hZ2VzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5hcnJheUNvcGllZEltYWdlcy5wb3AoKTtcbiAgICAgICAgbGV0IG5ld1ZhbHVlID0gdGhpcy5zdGF0ZS5hcnJheUNvcGllZEltYWdlc1t0aGlzLnN0YXRlLmFycmF5Q29waWVkSW1hZ2VzLmxlbmd0aCAtIDFdO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgIC4uLnRoaXMuc3RhdGUsXG4gICAgICAgICAgbWF4SGVpZ2h0OiBuZXdWYWx1ZS5oZWlnaHQsXG4gICAgICAgICAgbWF4V2lkdGg6IG5ld1ZhbHVlLndpZHRoLFxuICAgICAgICAgIHF1YWxpdHk6IG5ld1ZhbHVlLnF1YWxpdHksXG4gICAgICAgICAgZm9ybWF0OiBuZXdWYWx1ZS5mb3JtYXQsXG4gICAgICAgICAgb3JpZ2luSW1hZ2VTcmM6IG5ld1ZhbHVlLm9yaWdpbkltYWdlU3JjLFxuICAgICAgICAgIGJhc2ljRmlsdGVyczogbmV3VmFsdWUuYmFzaWNGaWx0ZXJzIGFzIElCYXNpY0ZpbHRlclN0YXRlLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmltYWdlU3JjID0gbmV3VmFsdWUubGFzdEltYWdlO1xuICAgICAgICB0aGlzLmNoUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qAIH4gZmlsZTogZWRpdC1pbWFnZS5jb21wb25lbnQudHMgfiBsaW5lIDEyNiB+IEVkaXRJbWFnZUNvbXBvbmVudCB+IG9uUmVzdG9yZSB+IGUnLCBlKTtcbiAgICB9XG4gIH1cblxuICBvbkNyb3BwVXBkYXRlKGRhdGE6IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH0pIHtcbiAgICB0aGlzLmNyb3BwU3RhdGUgPSBkYXRhO1xuICAgIHRoaXMuc3RhdGUuY3JvcEhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuICAgIHRoaXMuc3RhdGUuY3JvcFdpZHRoID0gZGF0YS53aWR0aDtcbiAgfVxuXG4gIG9uQ2hhbmdlQ3JvcCgpIHtcbiAgICB0aGlzLmNyb3BwU2l6ZSA9IHsgd2lkdGg6IHRoaXMuc3RhdGUuY3JvcFdpZHRoLCBoZWlnaHQ6IHRoaXMuc3RhdGUuY3JvcEhlaWdodCB9O1xuICB9XG5cbiAgb25Dcm9wKCkge1xuICAgIC8vIGNvbnN0IGRhdGFIb2xkZXJSZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyb3Bwci1jb250YWluZXInKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gY2FudmFzLmdldENvbnRleHQoJzJkJykgYXMgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuICAgICAgbGV0IGltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICBpbWFnZS5zcmMgPSB0aGlzLmltYWdlU3JjO1xuICAgICAgaW1hZ2Uub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAvLyBsZXQgcmF0aW8gPSBpbWFnZS5oZWlnaHQgLyBkYXRhSG9sZGVyUmVjdC5oZWlnaHQ7XG4gICAgICAgIGxldCBuZXdXaWR0aCA9IHRoaXMuY3JvcHBTdGF0ZT8ud2lkdGg7XG4gICAgICAgIGxldCBuZXdIZWlnaHQgPSB0aGlzLmNyb3BwU3RhdGU/LmhlaWdodDtcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IG5ld0hlaWdodCBhcyBudW1iZXI7XG4gICAgICAgIGNhbnZhcy53aWR0aCA9IG5ld1dpZHRoIGFzIG51bWJlcjtcbiAgICAgICAgY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICBpbWFnZSxcbiAgICAgICAgICBNYXRoLmFicyh0aGlzLmNyb3BwU3RhdGU/LnggfHwgMCksXG4gICAgICAgICAgTWF0aC5hYnModGhpcy5jcm9wcFN0YXRlPy55IHx8IDApLFxuICAgICAgICAgIHRoaXMuY3JvcHBTdGF0ZT8ud2lkdGggfHwgMCxcbiAgICAgICAgICB0aGlzLmNyb3BwU3RhdGU/LmhlaWdodCB8fCAwLFxuICAgICAgICAgIDAsXG4gICAgICAgICAgMCxcbiAgICAgICAgICB0aGlzLmNyb3BwU3RhdGU/LndpZHRoIHx8IDAsXG4gICAgICAgICAgdGhpcy5jcm9wcFN0YXRlPy5oZWlnaHQgfHwgMCxcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoY2FudmFzLnRvRGF0YVVSTChgaW1hZ2UvJHt0aGlzLnN0YXRlLmZvcm1hdH1gLCB0aGlzLnN0YXRlLnF1YWxpdHkpKTtcbiAgICAgIH07XG4gICAgICBpbWFnZS5vbmVycm9yID0gKGUpID0+IHtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfTtcbiAgICB9KVxuICAgICAgLnRoZW4oKGRhdGFVcmk6IGFueSkgPT4ge1xuICAgICAgICB0aGlzLmltYWdlU3JjID0gZGF0YVVyaTtcbiAgICAgICAgdGhpcy5zaG93Q3JvcCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0YXRlLm1heFdpZHRoID0gY2FudmFzLndpZHRoO1xuICAgICAgICB0aGlzLnN0YXRlLm1heEhlaWdodCA9IGNhbnZhcy5oZWlnaHQ7XG4gICAgICAgIHRoaXMuc3RhdGUub3JpZ2luSW1hZ2VTcmMgPSBkYXRhVXJpIGFzIHN0cmluZztcbiAgICAgICAgdGhpcy5zdGF0ZS5jcm9wSGVpZ2h0ID0gMTUwO1xuICAgICAgICB0aGlzLnN0YXRlLmNyb3BXaWR0aCA9IDE1MDtcbiAgICAgICAgc2F2ZVN0YXRlKHRoaXMuc3RhdGUsIGRhdGFVcmkgYXMgc3RyaW5nKTtcbiAgICAgICAgdGhpcy5jcm9wcFNpemUgPSB7IHdpZHRoOiAxNTAsIGhlaWdodDogMTUwIH07XG4gICAgICAgIHRoaXMuY2hSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgfSk7XG4gIH1cblxuICBhc3luYyBvbkNoYW5nZUZpbHRlcnMoZGF0YTogSUJhc2ljRmlsdGVyU3RhdGUpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCF0aGlzLnN0YXRlLmJhc2ljRmlsdGVycykge1xuICAgICAgICB0aGlzLnN0YXRlLmJhc2ljRmlsdGVycyA9IGRhdGE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0YXRlLmJhc2ljRmlsdGVycyA9IHsgLi4udGhpcy5zdGF0ZS5iYXNpY0ZpbHRlcnMsIC4uLmRhdGEgfTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW1hZ2VTcmMgPSBhd2FpdCBjb252ZXJ0SW1hZ2VVc2luZ0NhbnZhcyh0aGlzLnN0YXRlLm9yaWdpbkltYWdlU3JjLCBmYWxzZSwgdGhpcy5zdGF0ZSk7XG4gICAgICB0aGlzLmNoUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qAIH4gZmlsZTogZWRpdC1pbWFnZS5jb21wb25lbnQudHMgfiBsaW5lIDI1MCB+IEVkaXRJbWFnZUNvbXBvbmVudCB+IG9uQ2hhbmdlRmlsdGVycyB+IGUnLCBlKTtcbiAgICB9XG4gIH1cblxuICAvLyBhc3luYyBvblJvdGF0ZShkZWcgPSA5MCkge1xuICAvLyAgIHRyeSB7XG4gIC8vICAgICB0aGlzLmltYWdlU3JjID0gYXdhaXQgY29udmVydEltYWdlVXNpbmdDYW52YXModGhpcy5zdGF0ZS5vcmlnaW5JbWFnZVNyYywgZmFsc2UsIHRoaXMuc3RhdGUsIHsgcm90YXRlOiBkZWcgfSk7XG4gIC8vICAgICB0aGlzLmNoUmVmLm1hcmtGb3JDaGVjaygpO1xuICAvLyAgIH0gY2F0Y2ggKGUpIHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKCfwn5qAIH4gZmlsZTogZWRpdC1pbWFnZS5jb21wb25lbnQudHMgfiBsaW5lIDI1MCB+IEVkaXRJbWFnZUNvbXBvbmVudCB+IG9uUm90YXRlIH4gZScsIGUpO1xuICAvLyAgIH1cbiAgLy8gfVxufVxuIiwiPGRpdiBpZD1cInBvcHVwXCIgY2xhc3M9XCJwb3B1cFwiPlxuICA8ZGl2XG4gICAgc3R5bGU9XCJcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIHBsYWNlLWNvbnRlbnQ6IGNlbnRlciBmbGV4LWVuZDtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICBwYWRkaW5nOiAwcHggMTZweDtcbiAgICBcIlxuICA+XG4gICAgPGJ1dHRvbiBjbGFzcz1cImljb24tYnRuXCIgKGNsaWNrKT1cIm9uQ2xvc2VFZGl0UGFuZWwoZmFsc2UpXCI+XG4gICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+Y2xlYXI8L3NwYW4+XG4gICAgPC9idXR0b24+XG4gIDwvZGl2PlxuXG4gIDxkaXYgY2xhc3M9XCJpbWFnZS1jb250YWluZXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwiaW1hZ2UtaG9sZGVyLWZ1bGxcIj5cbiAgICAgIDxpbWcgaWQ9XCJpbWFnZS1mdWxsXCIgW3NyY109XCJ0aGlzLmltYWdlU3JjXCIgW3N0eWxlLmRpc3BsYXldPVwic2hvd0Nyb3AgPyAnbm9uZScgOiAnJ1wiIC8+XG5cbiAgICAgIDxsaWItY3JvcHBlci13cmFwcGVyXG4gICAgICAgIFtzZXRTaXplXT1cInRoaXMuY3JvcHBTaXplXCJcbiAgICAgICAgKGNyb3BwVXBkYXRlKT1cIm9uQ3JvcHBVcGRhdGUoJGV2ZW50KVwiXG4gICAgICAgIFtfaW1hZ2VTcmNdPVwidGhpcy5pbWFnZVNyY1wiXG4gICAgICAgICpuZ0lmPVwic2hvd0Nyb3BcIlxuICAgICAgPjwvbGliLWNyb3BwZXItd3JhcHBlcj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJjb250cm9sLXBhbmVsXCI+XG4gICAgICA8bGliLXRhYnMgW2NvbG9yXT1cInRoaXMuY29sb3JcIiBbX2xhYmVsc109XCJbJ0Jhc2ljJywgJ0ZpbHRlcnMnXVwiIChpbmRleEFjdGl2YXRlZENoYW5nZSk9XCJvbkNvbnRyb2xQYW5lbEluZGV4Q2hhbmdlKCRldmVudClcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImNvbnRyb2xQYW5lbEluZGV4ID09IDBcIj5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWlzTW9iaWxlIHx8IChpc01vYmlsZSAmJiAhc2hvd0Nyb3ApXCI+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgd2lkdGg6IDEwMCU7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlblwiPlxuICAgICAgICAgICAgICA8cCBjbGFzcz1cIml0ZW0tcGFuZWxcIj57eyBsYWJlbHNbJ1F1YWxpdHknXSB9fTwvcD5cbiAgICAgICAgICAgICAgPHAgY2xhc3M9XCJpdGVtLXBhbmVsXCI+e3sgdGhpcy5zdGF0ZS5xdWFsaXR5ICsgJyUnIH19PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJmbGV4LWRpcmVjdGlvbjogcm93OyBib3gtc2l6aW5nOiBib3JkZXItYm94OyBkaXNwbGF5OiBmbGV4OyBwbGFjZS1jb250ZW50OiBmbGV4LXN0YXJ0OyBhbGlnbi1pdGVtczogZmxleC1zdGFydFwiPlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICBbcmVhZG9ubHldPVwic2hvd0Nyb3BcIlxuICAgICAgICAgICAgICAgIFtkaXNhYmxlZF09XCJzaG93Q3JvcFwiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJpbnB1dC1yYW5nZVwiXG4gICAgICAgICAgICAgICAgKGNoYW5nZSk9XCJvbkNoYW5nZVF1YWxpdHkoKVwiXG4gICAgICAgICAgICAgICAgW25nU3R5bGVdPVwieyBtYXhXaWR0aDogJzEwMCUnLCB3aWR0aDogJzEwMCUnLCBjb2xvcjogY29sb3IgfVwiXG4gICAgICAgICAgICAgICAgWyhuZ01vZGVsKV09XCJ0aGlzLnN0YXRlLnF1YWxpdHlcIlxuICAgICAgICAgICAgICAgIHR5cGU9XCJyYW5nZVwiXG4gICAgICAgICAgICAgICAgbWluPVwiMVwiXG4gICAgICAgICAgICAgICAgbWF4PVwiMTAwXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT1cIjUwXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbS1wYW5lbFwiIHN0eWxlPVwiZGlzcGxheTogZmxleDsgd2lkdGg6IDEwMCU7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlblwiPlxuICAgICAgICAgICAgICB7eyBsYWJlbHNbJ01heCBkaW1lbnNpb25zJ10gfX1cbiAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgIFtyZWFkb25seV09XCJzaG93Q3JvcFwiXG4gICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwic2hvd0Nyb3BcIlxuICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgIFsobmdNb2RlbCldPVwidGhpcy5zdGF0ZS5tYWludGFpbkFzcGVjdFJhdGlvXCJcbiAgICAgICAgICAgICAgICAgIFtzdHlsZS5jb2xvcl09XCJjb2xvclwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNhcHRpb25cIj57eyBsYWJlbHNbJ2FzcGVjdC1yYXRpbyddIH19PC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIHN0eWxlPVwiXG4gICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogOHB4ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgZmxleC1mbG93OiByb3cgd3JhcDtcbiAgICAgICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgcGxhY2UtY29udGVudDogZmxleC1zdGFydCBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1maWVsZFwiIHN0eWxlPVwibWF4LXdpZHRoOiA0OCU7IHdpZHRoOiA0OCVcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWw+e3sgbGFiZWxzWydtYXgtd2lkdGgocHgpJ10gfX08L2xhYmVsPlxuICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgW3JlYWRvbmx5XT1cInNob3dDcm9wXCJcbiAgICAgICAgICAgICAgICAgIFtkaXNhYmxlZF09XCJzaG93Q3JvcFwiXG4gICAgICAgICAgICAgICAgICAoY2hhbmdlKT1cIm9uQ2hhbmdlU2l6ZShmYWxzZSlcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7eyBsYWJlbHNbJ21heC13aWR0aChweCknXSB9fVwiXG4gICAgICAgICAgICAgICAgICBbKG5nTW9kZWwpXT1cInRoaXMuc3RhdGUubWF4V2lkdGhcIlxuICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICBbbWluXT1cIjBcIlxuICAgICAgICAgICAgICAgICAgW21heF09XCIyMDAwXCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1maWVsZFwiIHN0eWxlPVwibWF4LXdpZHRoOiA0OCU7IHdpZHRoOiA0OCVcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWw+e3sgbGFiZWxzWydtYXgtaGVpZ2h0KHB4KSddIH19PC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgIFtyZWFkb25seV09XCJzaG93Q3JvcFwiXG4gICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwic2hvd0Nyb3BcIlxuICAgICAgICAgICAgICAgICAgKGNoYW5nZSk9XCJvbkNoYW5nZVNpemUodHJ1ZSlcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7eyBsYWJlbHNbJ21heC1oZWlnaHQocHgpJ10gfX1cIlxuICAgICAgICAgICAgICAgICAgWyhuZ01vZGVsKV09XCJ0aGlzLnN0YXRlLm1heEhlaWdodFwiXG4gICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgIFttaW5dPVwiMFwiXG4gICAgICAgICAgICAgICAgICBbbWF4XT1cIjIwMDBcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxwIGNsYXNzPVwiaXRlbS1wYW5lbFwiPnt7IGxhYmVsc1snRm9ybWF0J10gfX08L3A+XG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIHN0eWxlPVwiXG4gICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogOHB4ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgcGxhY2UtY29udGVudDogZmxleC1zdGFydDtcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDtcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZmllbGRcIiBzdHlsZT1cIndpZHRoOiAxMDAlXCI+XG4gICAgICAgICAgICAgICAgPHNlbGVjdCBbZGlzYWJsZWRdPVwic2hvd0Nyb3BcIiBbKG5nTW9kZWwpXT1cInRoaXMuc3RhdGUuZm9ybWF0XCIgKGNoYW5nZSk9XCJvbkNoYW5nZUZvcm1hdCgpXCI+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uICpuZ0Zvcj1cImxldCBmb3JtYXRJdGVtIG9mIGFsbEZvcm1hdHNcIiBbdmFsdWVdPVwiZm9ybWF0SXRlbVwiPnt7IGZvcm1hdEl0ZW0gfX08L29wdGlvbj5cbiAgICAgICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICA8IS0tIDxwIGNsYXNzPVwiaXRlbS1wYW5lbFwiPnt7IGxhYmVsc1snUm90YXRlJ10gfX08L3A+XG5cbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBzdHlsZT1cIlxuICAgICAgICAgICAgICBtYXJnaW4tdG9wOiA4cHggIWltcG9ydGFudDtcbiAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgcGxhY2UtY29udGVudDogZmxleC1zdGFydDtcbiAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XG4gICAgICAgICAgICBcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxidXR0b24gW2Rpc2FibGVkXT1cInNob3dDcm9wXCIgY2xhc3M9XCJpY29uLWJ0blwiIHN0eWxlPVwicGFkZGluZy1sZWZ0OiAwcHhcIiAoY2xpY2spPVwib25Sb3RhdGUoOTApXCI+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj4gcm90YXRlX2xlZnQgPC9zcGFuPlxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIFtkaXNhYmxlZF09XCJzaG93Q3JvcFwiIGNsYXNzPVwiaWNvbi1idG5cIiAoY2xpY2spPVwib25SZXN0b3JlKClcIiAoY2xpY2spPVwib25Sb3RhdGUoLTkwKVwiPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+IHJvdGF0ZV9yaWdodCA8L3NwYW4+XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxociAvPlxuICAgICAgICAgIDxiciAvPiAtLT5cblxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IG1hcmdpbi1ib3R0b206IDhweFwiPlxuICAgICAgICAgICAgPHNwYW4gc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBbKG5nTW9kZWwpXT1cInNob3dDcm9wXCIgW3N0eWxlLmNvbG9yXT1cImNvbG9yXCIgc3R5bGU9XCJtYXJnaW4tYm90dG9tOiAzcHhcIiAvPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIml0ZW0tcGFuZWxcIiBzdHlsZT1cIm1hcmdpbi1sZWZ0OiA0cHhcIj57eyBsYWJlbHNbJ0Nyb3AnXSB9fTwvc3Bhbj5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJzaG93Q3JvcFwiPlxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBzdHlsZT1cIlxuICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDhweCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgICAgIGZsZXgtZmxvdzogcm93IHdyYXA7XG4gICAgICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgIHBsYWNlLWNvbnRlbnQ6IGZsZXgtc3RhcnQgc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDtcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZmllbGRcIiBzdHlsZT1cIm1heC13aWR0aDogNDglOyB3aWR0aDogNDglOyBtYXJnaW4tYm90dG9tOiA4cHhcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWw+e3sgbGFiZWxzWyd3aWR0aChweCknXSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAoY2hhbmdlKT1cIm9uQ2hhbmdlQ3JvcCgpXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwie3sgbGFiZWxzWyd3aWR0aChweCknXSB9fVwiXG4gICAgICAgICAgICAgICAgICBbKG5nTW9kZWwpXT1cInN0YXRlLmNyb3BXaWR0aFwiXG4gICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgIFttaW5dPVwiMFwiXG4gICAgICAgICAgICAgICAgICBbbWF4XT1cIjIwMDBcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1maWVsZFwiIHN0eWxlPVwibWF4LXdpZHRoOiA0OCU7IHdpZHRoOiA0OCU7IG1hcmdpbi1ib3R0b206IDhweFwiPlxuICAgICAgICAgICAgICAgIDxsYWJlbD57eyBsYWJlbHNbJ2hlaWdodChweCknXSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAoY2hhbmdlKT1cIm9uQ2hhbmdlQ3JvcCgpXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwie3sgbGFiZWxzWydoZWlnaHQocHgpJ10gfX1cIlxuICAgICAgICAgICAgICAgICAgWyhuZ01vZGVsKV09XCJzdGF0ZS5jcm9wSGVpZ2h0XCJcbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgW21pbl09XCIwXCJcbiAgICAgICAgICAgICAgICAgIFttYXhdPVwiMjAwMFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW4tYm90dG9tOiA0cHggIWltcG9ydGFudFwiPlxuICAgICAgICAgICAgICA8YnV0dG9uIHRpdGxlPVwiQ3V0IHRoZSBpbWFnZVwiIGNsYXNzPVwiaWNvbi1idG5cIiAoY2xpY2spPVwib25Dcm9wKClcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+IGNyb3AgPC9zcGFuPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb250cm9sUGFuZWxJbmRleCA9PSAxXCI+XG4gICAgICAgICAgPGxpYi1iYXNpYy1maWx0ZXJzXG4gICAgICAgICAgICBbZmlsdGVyU3RhdGVdPVwidGhpcy5zdGF0ZS5iYXNpY0ZpbHRlcnNcIlxuICAgICAgICAgICAgKGNoYW5nZUZpbHRlcik9XCJvbkNoYW5nZUZpbHRlcnMoJGV2ZW50KVwiXG4gICAgICAgICAgICBbbGFiZWxzXT1cInRoaXMubGFiZWxzXCJcbiAgICAgICAgICAgIFtjb2xvcl09XCJ0aGlzLmNvbG9yXCJcbiAgICAgICAgICA+PC9saWItYmFzaWMtZmlsdGVycz5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8L2xpYi10YWJzPlxuXG4gICAgICA8YnV0dG9uXG4gICAgICAgIHRpdGxlPVwie3sgbGFiZWxzWydVbmRvJ10gfX1cIlxuICAgICAgICBbZGlzYWJsZWRdPVwidGhpcy5zdGF0ZS5hcnJheUNvcGllZEltYWdlcy5sZW5ndGggPD0gMVwiXG4gICAgICAgIHN0eWxlPVwicG9zaXRpb246IGFic29sdXRlOyByaWdodDogMTBweDsgdG9wOiAzMHB4XCJcbiAgICAgICAgY2xhc3M9XCJpY29uLWJ0blwiXG4gICAgICAgIChjbGljayk9XCJvblJlc3RvcmUoKVwiXG4gICAgICA+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj4gcmVmcmVzaCA8L3NwYW4+XG4gICAgICA8L2J1dHRvbj5cbiAgICAgIDxkaXZcbiAgICAgICAgc3R5bGU9XCJcbiAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBwbGFjZS1jb250ZW50OiBjZW50ZXIgc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgIG1hcmdpbi10b3A6IDhweDtcbiAgICAgICAgXCJcbiAgICAgID5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInNhdmUtYnRuXCIgKGNsaWNrKT1cIm9uQ2xvc2VFZGl0UGFuZWwodHJ1ZSlcIj57eyBsYWJlbHNbJ1NhdmUnXSB9fTwvYnV0dG9uPlxuXG4gICAgICAgIDxwXG4gICAgICAgICAgKm5nSWY9XCJ0aGlzLmNhbGN1bGF0ZVNpemUoKVwiXG4gICAgICAgICAgY2xhc3M9XCJjYXB0aW9uIGltYWdlLWNhcHRpb25cIlxuICAgICAgICAgIFtuZ1N0eWxlXT1cIntcbiAgICAgICAgICAgIGNvbG9yOiB0aGlzLmNhbGN1bGF0ZVNpemUoKSA+IDEyMCA/ICcjZjQ0MzM2JyA6ICd1bnNldCcsXG4gICAgICAgICAgICBmb250V2VpZ2h0OiB0aGlzLmNhbGN1bGF0ZVNpemUoKSA+IDEyMCA/ICc1MDAnIDogJ3Vuc2V0J1xuICAgICAgICAgIH1cIlxuICAgICAgICA+XG4gICAgICAgICAgc2l6ZToge3sgdGhpcy5jYWxjdWxhdGVTaXplKCkgfX1LYiAmbmJzcDsge3sgdGhpcy5zdGF0ZS5mb3JtYXQgfX1cbiAgICAgICAgPC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC9kaXY+XG4iXX0=